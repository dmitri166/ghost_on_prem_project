# Ghost Application Service Monitors
# Custom service monitors for Ghost applications and MySQL

---
# Ghost Dev Service Monitor
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: ghost-dev-metrics
  namespace: monitoring
  labels:
    app.kubernetes.io/name: ghost
    app.kubernetes.io/component: monitoring
    app.kubernetes.io/env: dev
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: ghost
      app.kubernetes.io/env: dev
  namespaceSelector:
    matchNames:
      - ghost-dev
  endpoints:
  - port: http
    path: /metrics
    interval: 30s
    scrapeTimeout: 10s

---
# Ghost Staging Service Monitor
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: ghost-staging-metrics
  namespace: monitoring
  labels:
    app.kubernetes.io/name: ghost
    app.kubernetes.io/component: monitoring
    app.kubernetes.io/env: staging
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: ghost
      app.kubernetes.io/env: staging
  namespaceSelector:
    matchNames:
      - ghost-staging
  endpoints:
  - port: http
    path: /metrics
    interval: 30s
    scrapeTimeout: 10s

---
# Ghost Prod Service Monitor
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: ghost-prod-metrics
  namespace: monitoring
  labels:
    app.kubernetes.io/name: ghost
    app.kubernetes.io/component: monitoring
    app.kubernetes.io/env: prod
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: ghost
      app.kubernetes.io/env: prod
  namespaceSelector:
    matchNames:
      - ghost-prod
  endpoints:
  - port: http
    path: /metrics
    interval: 30s
    scrapeTimeout: 10s

---
# MySQL Dev Service Monitor
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: mysql-dev-metrics
  namespace: monitoring
  labels:
    app.kubernetes.io/name: mysql
    app.kubernetes.io/component: monitoring
    app.kubernetes.io/env: dev
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: mysql
      app.kubernetes.io/env: dev
  namespaceSelector:
    matchNames:
      - ghost-dev
  endpoints:
  - port: metrics
    path: /metrics
    interval: 30s
    scrapeTimeout: 10s

---
# MySQL Staging Service Monitor
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: mysql-staging-metrics
  namespace: monitoring
  labels:
    app.kubernetes.io/name: mysql
    app.kubernetes.io/component: monitoring
    app.kubernetes.io/env: staging
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: mysql
      app.kubernetes.io/env: staging
  namespaceSelector:
    matchNames:
      - ghost-staging
  endpoints:
  - port: metrics
    path: /metrics
    interval: 30s
    scrapeTimeout: 10s

---
# MySQL Prod Service Monitor
apiVersion: monitoring.coreos.com/v1
kind: ServiceMonitor
metadata:
  name: mysql-prod-metrics
  namespace: monitoring
  labels:
    app.kubernetes.io/name: mysql
    app.kubernetes.io/component: monitoring
    app.kubernetes.io/env: prod
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: mysql
      app.kubernetes.io/env: prod
  namespaceSelector:
    matchNames:
      - ghost-prod
  endpoints:
  - port: metrics
    path: /metrics
    interval: 30s
    scrapeTimeout: 10s
